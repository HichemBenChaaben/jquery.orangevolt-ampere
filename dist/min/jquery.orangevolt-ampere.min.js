/*!
 * jQuery Orangevolt Ampere
 *
 * version : 0.1.0
 * created : 2012-10-10
 * source  : https://github.com/lgersman/jquery.orangevolt-ampere
 *
 * author  : Lars Gersmann (lars.gersmann@gmail.com)
 * homepage: http://www.orangevolt.com
 *
 * Copyright (c) 2012 Lars Gersmann; Licensed MIT, GPL
 */
jQuery.ov&&jQuery.ov.compat||function(e){e.ov=e.ov||{},e.ov.compat={},Object.keys&&Object.keys.toString().indexOf("[native code]")==-1&&(Object.keys=function(t){var n=[];if(this){if(!e.isArray(t)){var i=[];for(var s in t)Object.hasOwnProperty.call(t,s)&&(i[i.length]=s);return i}for(var r=0;r<t.length;r++)n.push(r)}return n})}(jQuery),jQuery.ov&&jQuery.ov.json||function(e){function i(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,function(e){var t=r[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function s(t){return t=t.jquery?t:e(t),t.length>0?t.map(function(){var e=this.getAttribute?this.getAttribute("id")||this.getAttribute("name"):"";return this.tagName+(e?"#"+e:"")}).get().join(", "):t.jquery?t.selector:t.toString()}var t=["abstract","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with"],n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};jQuery.ov.json={stringify:function(n,r){if(!e.isArray(this))return jQuery.ov.json.stringify.call([],n,r);r=r||{},r.indent=r.indent||"  ",r._currindent=r._currindent||"",r._linebreak=r._linebreak||"\r\n",r.alignPropertyNames=r.alignPropertyNames===!1?!1:!0,r.optimizePropertyNames=r.optimizePropertyNames===!1?!1:!0;var o=typeof n;if(n===window)return"<Window>window";if(n===window.document)return"<Document>window.document";if(o=="object"&&n!==null&&n!==undefined&&n.nodeType)return"<HTMLElement>"+s(n);if(o!="object"||n===null)return o=="string"&&(n=i(n)),String(n);var u,a,f,l=[],c=e.isArray(n),h=Object.keys(n),p=0;if(r.alignPropertyNames)for(u=0;u<h.length;u++)p=Math.max(p,h[u].length);for(u=0;u<h.length;u++){a=h[u],f=n[a],o=typeof f;if(o=="function"&&r.skipFunctions)continue;if(f===null&&r.skipNull)continue;if(o=="undefined"&&r.skipUndefined)continue;if(f!==null)if(o!="object"||e.inArray(f,this)==-1){o!="object"||this.push(f);var d=e.extend({},r);d._currindent=r._currindent+r.indent,f=jQuery.ov.json.stringify.call(this,f,d)}else f="(circular ref ... "+f+")";a=r.optimizePropertyNames&&e.inArray(a.toString().toLowerCase(),t)==-1?a:'"'+a+'"';var v="  ";if(r.alignPropertyNames){var m=p-a.length;while(m-->0)v=v.concat(" ")}l.push((c?"":a+v+": ")+String(f))}return h.length?l=r._linebreak+r._currindent+r.indent+l.join(","+r._linebreak+r._currindent+r.indent)+r._linebreak+(r._currindent.length>0?r._currindent.substring(0,r._currindent.length-0):r._currindent):l="",(c?"[":"{")+l+(c?"]":"}")}},e.extend(e.ov.json.stringify,{COMPACT:{indent:"",linebreak:"",skipFunctions:!0,alignPropertyNames:!1,optimizePropertyNames:!0},FORMATTED:{indent:"  ",linebreak:"\r\n",skipFunctions:!0,alignPropertyNames:!0,optimizePropertyNames:!0}});if(!window.JSON){var o={indent:"",linebreak:"",skipFunctions:!0,alignPropertyNames:!1,optimizePropertyNames:!1};window.JSON={stringify:function(t,n,r){return e.ov.json.stringify(t,o)}}}}(jQuery),jQuery.ov&&jQuery.ov.namespace||function(e){function t(){var t="";for(var n=0;n<arguments.length;n++){var r=e.isFunction(arguments[n])?arguments[n]():arguments[n];r&&r.jquery&&(t+="<jQuery>",r=r.get(),r=r.length==1?r[0]:r),r&&r.nodeType?t+=e.ov.json.stringify(r,e.ov.json.stringify.COMPACT):r===null||r===undefined||typeof r=="object"?t+=e.ov.json.stringify(r,e.ov.json.stringify.COMPACT):t+=r}return t}function n(t){var n={},r=e.noop;return window.console&&(r=window.console[t]||window.console.log||e.noop),n[r]||(n[r]=r===e.noop?e.noop:e.proxy(r,window.console))}e.ov=e.ov||{},e.ov.namespace=function(t){return t||(t=""),e.ov.namespace[t]?e.ov.namespace[t]:this instanceof e.ov.namespace?(this._namespace=t,e.ov.namespace[t]=this):new e.ov.namespace(t)},e.ov.namespace.filter=function(e,t){},e.ov.namespace.prototype={debug:function(){var r=e.ov.namespace.filter("debug",this._namespace);if(r!==undefined&&!r)return;var i=e.makeArray(arguments);return i.unshift("#DEBUG: "),i.unshift(this._namespace),n("debug").call(this,t.apply(this,i)),this},error:function(){var r=e.ov.namespace.filter("error",this._namespace);if(r!==undefined&&!r)return;var i=e.makeArray(arguments);return i.unshift("#ERROR: "),i.unshift(this._namespace),n("error").call(this,t.apply(this,i)),this},warn:function(){var r=e.ov.namespace.filter("warn",this._namespace);if(r!==undefined&&!r)return;var i=e.makeArray(arguments);return i.unshift("#WARN: "),i.unshift(this._namespace),n("warn").call(this,t.apply(this,i)),this},assert:function(n){var r=e.makeArray(arguments);r.shift();if(!n){r.length||r.push("assertion failed"),r.unshift("#ASSERT: "),r.unshift(this._namespace);var i=t.apply(this,r);throw new Error(i)}return this},raise:function(){var n=e.makeArray(arguments);throw n.unshift("#ERROR: "),n.unshift(this._namespace),new Error(t.apply(this,n))},attempt:function(n){var r=e.makeArray(arguments);r.shift(),this.assert(e.isFunction(n),"first argument expected to be a function");var i;try{i=n.call(this)}catch(s){r.length||r.push("problem executing function "+n.name),r.push(" : "+(s.message||s)),r.unshift("#ATTEMPT: "),r.unshift(this._namespace);var o=t.apply(this,r);throw new Error(o)}return this}}}(jQuery),jQuery&&jQuery.fn.upload||function(e){if(!(e.support.ajaxProgress="onprogress"in e.ajaxSettings.xhr()))return;var t=e.ajax;e.ajax=function(r,i){typeof r=="object"&&(i=r,r=i.url),i=i||{};var s=e.Deferred(),o=i.xhr||e.ajaxSettings.xhr,u;i.xhr=function(){var t=this,n=o.call(e.ajaxSettings);if(n){var r=function(n){return function(r){t.global&&e.event.trigger("ajaxProgress",[r,n,u]),e.isFunction(t.progress)&&t.progress(u,r,n),s.notifyWith(u,[r,n])}};n.upload.addEventListener("progress",r(!0),!1),n.addEventListener("progress",r(!1),!1)}return n},u=t.call(this,r,i);for(var a in s.promise())u[a](s[a]);return u.progress=s.progress,u},e.upload=function(t,n,r,i){return jQuery.isFunction(n)&&(i=i||r,r=n,n=undefined),e.ajax({processData:!1,contentType:!1,type:"POST",url:t,data:n,success:r,dataType:i})}}(jQuery),window.ov&&window.ov.ampere||function(e){function t(e){var t=[];for(var n in e)t.push(e[n]);return t}function Options(t){var n=t||{};return function(){if(arguments.length==2)return n[arguments[0]]=arguments[1],this;if(arguments.length==1){var r=arguments[0];return e.isPlainObject(r)?(angular.extend(n,r),this):n[r]}return n}}function History(t,n){if(this instanceof History){n=n||{};var r=n["ampere.history.limit"];r=r===undefined||r===null?0:r;var i=this;this.canUndo=function(){return i.position},this.canRedo=function(){return i.stack.length-i.position},this.canReset=function(){return i.stack.length};var s;this.retry=function(){},this.canRetry=function(){return s};var o;return r&&n["ampere.history.html5"]&&window.history&&window.history.pushState&&(o=parseInt(e.now()+"00",10),window.history.replaceState(o,document.title,window.location.pathname),e(window).on("popstate",function(e){if(e.originalEvent.state)for(var t=0;t<i.stack.length;t++){var n=i.stack[t];if(n.hash==e.originalEvent.state){t<i.position?i.undo(e):i.redo(e);return}}})),this.redo=function(){var n;if(arguments.length){if(!(arguments[0]instanceof jQuery.Event)){var s=arguments.length&&arguments[0].ui,u=arguments[0],a=t.current().view,f;n=function(i){var s=t._transit(u.command,u.source,u.target,u.view,u.ui,i);return f||e.isFunction(s)&&(f=function(i){var o=t._transit(s,u.target,u.source,a,u.ui,i);return n.promise=e.when(o).promise,e.isFunction(o)?n:undefined},f.target=u.source,f.view=a),f&&(f.promise=e.when(s).promise),e.isFunction(s)?f:undefined},n.target=u.target,n.view=u.view}}else o&&i.canRedo()&&!(arguments[0]instanceof jQuery.Event)&&window.history.forward();var l=e.Deferred(),c=n||i.canRedo()&&i.stack[i.position],h=e.isFunction(c)&&c(l);return e.when(h).done(function(){r>0&&(h?(h.hash=window.history.state,n?(i.stack.splice(i.position),i.stack.push(h),i.position=i.stack.length,o&&l.done(function(){var e=++o;window.history.pushState(e,document.title,window.location.pathname)})):i.canRedo()&&(o&&l.done(function(){h.hash=c.hash-1}),i.stack[i.position++]=h)):c&&(i.stack.splice(0,i.position),i.position=i.stack.length),i.stack.length>r&&(i.stack.shift(),i.position=i.stack.length))}).always(l.resolve),c},this.redo.target=function(){return i.canRedo()&&i.stack[i.position].target},this.undo=function(){if(i.canUndo()){o&&!(arguments[0]instanceof jQuery.Event)&&window.history.back();var t=i.stack[--i.position],n=e.Deferred(),r=t(n);e.when(r).done(function(){r?(o&&n.done(function(){r.hash=t.hash+1}),i.stack[i.position]=r):i.stack.splice(i.position)}).always(n.resolve)}return this},this.undo.target=function(){return i.canUndo()&&i.stack[i.position-1].target},this.reset=function(){return i.stack=[],i.position=0,i},this.reset.target=function(){return t.current().state},this.rewind=function(){while(this.canUndo())this.undo(!1);return this},this.playback=function(){while(this.canRedo())this.redo(!1);return this},this.reset(),this}return new History(t,n)}function Transition(t,n,r,i){if(!(this instanceof Transition))return new Transition(t,n,r,i);var s=this;this.options=Options(),this.state=function(){return t||i.current().state},this.name=function(){return r},this.fullName=function(){return(t||i).fullName()+".transitions."+r},this.target=function(){return e.isFunction(n)?n.call(this):n},this.action=function(){function t(){return t}var n=t;return function(){return arguments.length?(e.ov.namespace(this.fullName()+".action()").assert(arguments.length==1&&e.isFunction(arguments[0]),"function expected as argument"),n=arguments[0],this):n}}(),this.enabled=function(){var t=function(){return!0};return function(){if(arguments.length){var n=arguments[0];if(!e.isFunction(n)){var r=arguments[0];n=function(){return r}}return e.ov.namespace(this.fullName()+".enabled()").assert(arguments.length==1,"single argument expected"),t=n,this}var i=t.call(this,this);return i}}(),this.active=function(){var t=e.noop;return function(){if(arguments.length){var n=arguments[0];if(!e.isFunction(n)){var r=arguments[0];n=function(){return r}}return e.ov.namespace(this.fullName()+".active()").assert(arguments.length==1,"single argument expected"),t=n,this}var i=t.call(this,this);return i}}()}function View(e,t,n){if(!(this instanceof View))return new View(e,t,n);var r=this;this.options=Options(),this.state=function(){return e},this.name=function(){return t},this.fullName=function(){return e.fullName()+".views."+t},this.template=function(){return n}}function State(n,r){if(!(this instanceof State))return new State(n,r);var i=this;this.options=Options(),this.module=function(){return n},this.name=function(){return r},this.fullName=function(){return n.fullName()+".states."+r};var s=this;this._super=function(e){},this.transitions={},this.transition=function(){var r=e.ov.namespace(this.fullName()+".transition()"),i,s;return arguments.length?arguments.length==1?typeof arguments[0]=="string"?(i=this,s=arguments[0]):arguments[0]instanceof State?(i=arguments[0],s=i.name()):e.isFunction(arguments[0])?(i=arguments[0],s=window.ov.ampere.util.functionName(i)?window.ov.ampere.util.functionName(i):"main"):r.raise("dont know how to handle arguments ",arguments):arguments.length==2?(s=arguments[0],i=arguments[1]):r.raise("too much arguments ",arguments):(i=this,s=i.name()),r.assert(e.isFunction(i)||i instanceof State,"argument targetState expected to be a state or function returning a state, but it is ",i).assert(e.isFunction(i)||e.inArray(i,t(n.states))!=-1,"argument targetState expected to be a state of same module").assert(!this.transitions[s],'transition "',s,'" already exists'),this.transitions[s]=Transition(this,i,s),this.transitions[s]},this.views={},this.view=function(){var t=e.ov.namespace(this.fullName()+".view()").assert(arguments.length,"no arguments given"),n=arguments.length>1?arguments[0]:undefined,r=arguments[arguments.length>1?1:0];return n||(e.isFunction(r)?n=window.ov.ampere.util.functionName(r):(r||{}).jquery&&(n=r.selector),n=n||"main"),t.assert(!this.views[n],'view "'+n+'" already exists'),t.assert(r||r===""||r==null,'view "'+n+'" : template argument missing'),this.views[n]=new View(this,n,r)},this.view.load=function(t,n){return arguments.length==1?i.view("main",e.get(arguments[0])):i.view(t||"main",e.get(n))}}function Module(n,r){if(!(this instanceof Module))return new Module(n,r);this.ampere=function(){return n},this.name=function(){return r},this.fullName=function(){return"ampere.modules."+r},this._super=function(){var n=this;this.options=Options();var r={state:undefined,view:undefined,reset:undefined};this.current=function(i,s,o){if(arguments.length==2||arguments.length==3){e.ov.namespace(n.fullName()+".current()").assert(e.inArray(i,t(n.states))!=-1,"argument expected to be state of same module"),e.ov.namespace(n.fullName()+".current()").assert(!s||e.inArray(s,t(i.views))!=-1,'argument expected to be view of state "',i.name(),'"'),r.state=i,r.view=s,r.reset={};var u=Object.keys(i);for(var a=0;a<u.length;a++)u[a]!="promise"&&(typeof r.state[u[a]]!="object"||e.isPlainObject(r.state[u[a]]))&&(e.ov.namespace(n.fullName()+".current.reset()").debug("backup property ",u[a]),r.reset[u[a]]=angular.copy(r.state[u[a]]))}else{if(!arguments.length)return r;e.ov.namespace(n.fullName()+".current()").raise("2 or no arguments expected but ",arguments," given")}},this.current.reset=function(){var t,i=Object.keys(r.state);for(t=0;t<i.length;t++)i[t]!="promise"&&(e.ov.namespace(n.fullName()+".current.reset()").debug("delete property ",i[t]),delete r.state[i[t]]);i=Object.keys(r.reset);for(t=0;t<i.length;t++)if(typeof r.reset[i[t]]!="object"||e.isPlainObject(r.reset[i[t]]))e.ov.namespace(n.fullName()+".current.reset()").debug("set property ",i[t],"=",r.reset[i[t]]),r.state[i[t]]=angular.copy(r.reset[i[t]])},this.states={},this.state=function(){var t=e.ov.namespace(this.fullName()+".state()").assert(arguments.length,"no arguments given"),n,r;if(arguments.length==1&&e.isArray(arguments[0])){var i=arguments[0];for(r=0;r<i.length;r++)t.assert(e.isFunction(i[r])||typeof i[r]=="string",'array item type "function" or "string" expected'),this.state(e.isFunction(i[r])?window.ov.ampere.util.functionName(i[r]):i[r]);for(r=0;r<i.length;r++)e.isFunction(i[r])&&i[r].call(this.states[window.ov.ampere.util.functionName(i[r])],this.states[window.ov.ampere.util.functionName(i[r])]);return this}if(arguments.length==1&&e.isPlainObject(arguments[0])){var s=arguments[0];for(n in s)this.state(n);var o=[];for(n in s)t.assert(e.isFunction(s[n]),'initializer function expected as value of state "',n+'"'),o.push(s[n].call(this.states[n],this.states[n]));return this.promise=e.when.apply(e.when,o).promise,this}var u=e.makeArray(arguments);n=u.shift();var a=e.isFunction(n)?n:u.shift()||e.noop;n=typeof n=="string"?n:window.ov.ampere.util.functionName(n),t.assert(!this.states[n],'state "'+n+'" already exists');var f=function(){var t=[];e.isFunction(this.promise)&&t.push(this.promise()),t.push(a.call(this,this)),this.promise=e.when.apply(e.when,t).promise};return f.prototype=State(this,n),this.states[n]=new f,this.states[n]},this.transitions={},this.transition=function(){var r=e.ov.namespace(this.fullName()+".transition()").assert(arguments.length,"no arguments given"),i,s;return arguments.length&&(arguments.length==1?arguments[0]instanceof State?(i=arguments[0],s=i.name()):e.isFunction(arguments[0])?(i=arguments[0],s=window.ov.ampere.util.functionName(i)!==""?window.ov.ampere.util.functionName(i):"main"):typeof arguments[0]=="string"?(i=this.states[arguments[0]],s=arguments[0]):r.raise("dont know how to handle arguments ",arguments):arguments.length==2?(s=arguments[0],i=arguments[1]):r.raise("dont know how to handle arguments ",arguments)),r.assert(e.isFunction(i)||i instanceof State,"argument targetState expected to be a state or function returning a state, but it is ",i).assert(e.isFunction(i)||e.inArray(i,t(n.states))!=-1,"argument targetState expected to be a state of same module").assert(!this.transitions[s],'transition "',s,'" already exists'),this.transitions[s]=Transition(null,i,s,this),this.transitions[s]},this._transit=function(t,r,i,s,o,u){function h(){if(arguments.length==1&&arguments[0]==c)o&&o.unblock();else if(o){var t=function(){n.history().redo(a)};if(arguments.length==1&&typeof arguments[0]=="string")o.render("Error",arguments[0],t);else{if(arguments.length==1&&arguments[0]instanceof Error)throw o.render("Error",arguments[0],t),arguments[0];if(arguments.length==3&&e.isFunction(arguments[0].statusCode))throw o.render("Error","Ajax request failed ("+arguments[0].status+") : "+arguments[0].statusText||arguments[0].responseText,t),arguments[0].responseText;o.render("Error",e.ov.json.stringify(arguments,e.ov.json.stringify.COMPACT),t)}}}var a={command:t,source:r,target:i,view:s,ui:o};o&&o.block();var f;if(t)try{f=t.call(t,r,i)}catch(l){f=e.Deferred(),f.reject(l)}f&&e.isFunction(f.promise)&&f.promise().state()=="pending"&&o&&o.render("Action",f);var c=this;return e.when(f,u).done(function(){n.current(i,s);var t=o&&o.getTemplate(s);t.done(function(n){n instanceof HTMLElement&&(n=e(n)),t=n.jquery?n[0].tagName=="SCRIPT"?n.text().replace("<![CDATA[","").replace("]]>",""):n:t.responseText||n,o&&o.render("State",s,t,f),o&&o.unblock()}).fail(h)}).fail(h),f}}}function Ampere(n){if(!(this instanceof Ampere))return new Ampere(n);var r=this;this.options=Options(angular.extend({},Ampere.defaults,n)),this.modules={},this.module=function(){var i=e.ov.namespace("ampere.module()").assert(arguments.length,"no arguments given"),s=e.makeArray(arguments),o=s.shift();typeof o=="string"&&!s.length&&i.assert(!1,"not enough arguments : ",arguments);var u=e.isFunction(o)?o:s.shift();o=typeof o=="string"?o:window.ov.ampere.util.functionName(u),i.assert(o&&o!=="","module name not given (module constructor function seems also anonymous)"),i.assert(!this.modules[o],'module "'+o+'" already exists');var a={};return this.modules[o]=function(n){if(!(this instanceof Module))return new this.modules[o];this._super(),this.options(angular.extend({},this.ampere().options(),a,n));var r=History(this,this.options());this.history=function(){return r};var s=u.call(this,this);i.assert(!e.isEmptyObject(this.states),"cannot instantiate module without any states");var f=t(this.states);f.push(s),e.isFunction(this.promise)&&f.push(this.promise());var l=this;this.promise=e.when.apply(e.when,f).done(function(){var t=function(e,t){return t.getCaption(e.state())},n=function(e,t){return t.getDescription(e.state())};for(var r in l.states){var i=l.states[r];e.isEmptyObject(i.views)&&i.view("main",null).options({"ampere.ui.caption":t,"ampere.ui.description":n})}}).fail(function(){i.error('failed to load module "',l.name(),'" : ',arguments)}).promise},this.modules[o].defaults=function(e){return a=e,r.modules[o]},this.modules[o].prototype=Module(r,o),this.modules[o]}}function Ui(){if(!(this instanceof Ui))return new Ui;this._super=function(t,n){this.options=Options(angular.extend({},Ampere.defaults.ui,n)),this.controller=t,this._ns=e.ov.namespace(t.module.fullName()+"::UI");var r=this;this.onHotKey=function(n){if(!r.isBlocked()){var i=window.ov.ampere.ui.hotkey.computeMatchingHotkeys(n),s=r.controller.module,o=function(t,s,o){var u=s||t.options("ampere.ui.hotkey");if(t.enabled()&&u){var a=u.replace(/\+/g,"_").toLowerCase();if(e.inArray(a,i)!=-1)return r._ns.debug("hotkey "+u+" matched"),n.preventDefault(),n.stopImmediatePropagation(),n.currentTarget=n.delegateTarget=n.srcElement=n.target=o,r.controller.proceed(t,[n]),!0}},u,a,f=e("*[ng-ampere-hotkey]",r.controller.element).get();for(u in f){a=e(f[u]);var l=a.data("ampereHotkey");for(var c in l){var h=c.replace(/\+/g,"_").toLowerCase();if(e.inArray(h,i)!=-1){r._ns.debug("hotkey "+c+" matched"),n.preventDefault(),n.stopImmediatePropagation();var p=l[c];if(p instanceof Transition)n.currentTarget=n.delegateTarget=n.srcElement=n.target=a[0],r.controller.proceed(p,[n]);else{var d=angular.element(a).scope();d.$apply(p)}return}}}f=e('.ampere-transition[data-ampere-hotkey!=""]',r.controller.element).get();for(u in f){a=e(f[u]);if(a.hasClass("ampere-transition")){var v=a.data("ampereTransition");if(v&&o(v,undefined,a.data("ampere-hotkey",r.controller.element),a[0]))return}}for(u in s.current().state.transitions)if(o(s.current().state.transitions[u],undefined,e(".ampere-view:first",r.controller.element)[0]))return;for(u in s.transitions)if(o(s.transitions[u],undefined,e(".ampere-module:first",r.controller.element)[0]))return}}},this.init=function(){e(this.controller.element).on("keydown",this.onHotKey)},this.destroy=function(){e(this.controller.element).off("keydown",this.onHotKey)},this.block=function(){},this.unblock=function(){},this.isBlocked=function(){},this.flash=function(e){},this.flash.error=function(e,t){},this.flash.progress=function(e,t,n){},this.modal=function(e,t,n){},this.getTransitions=function(t){var n=t||e.noop;e.isFunction(n)||(this._ns.assert(e.isPlainObject(t),'argument "filter" expected to be a function or plain object'),n=function(){for(var e in t){var n=t[e],r=this.options(e);return n instanceof RegExp?n.test(r||""):n===r}});var r,i,s,o=[];r=Object.keys(this.controller.module.transitions);for(i in r)s=this.controller.module.transitions[r[i]],n.call(s)&&o.push(s);r=Object.keys(this.controller.module.current().state.transitions);for(i in r)s=this.controller.module.current().state.transitions[r[i]],n.call(s)&&o.push(s);return o},this.regexp=function(e,t){return new RegExp(e,t)},this.render=function(t){if(e.isFunction(this["render"+t])){var n=e.makeArray(arguments);return n.shift(),this["render"+t].apply(this,n)}e.ov.namespace("ampere.ui").debug('skip rendering event "'+t+'" for module "'+this.controller.module.fullName()+'" - no matching function "render'+t+'" defined in renderer')},this._get=function(t,n,r){if(!n)debugger;var i;e.isFunction(this.options(t))&&(i=this.options(t).call(this,n));if(i===undefined&&e.isFunction(n.options)){if(n instanceof Transition){i=n.options(t);var s=n.target();i===undefined&&e.inArray("target",r)!=-1&&s&&s!==n.state()&&(n=s)}n instanceof View&&(i=n.options(t),i===undefined&&e.inArray("state",r)!=-1&&(n=n.state())),n instanceof State&&(i=n.options(t),i===undefined&&e.inArray("module",r)!=-1&&(n=n.module())),n instanceof Module&&(i=n.options(t))}return e.isFunction(i)?i.call(n,n,this):i},this.getHotkey=function(e){var t=this._get("ampere.ui.hotkey",e,["transition","view","target","state"]);return typeof t=="string"?window.ov.ampere.util.ucwords(t):t},this.getCaption=function(e){var t=this._get("ampere.ui.caption",e,["transition","view","target","state"]);return t===undefined&&(e instanceof Transition?t=window.ov.ampere.util.ucwords(e.name()):e instanceof View?t=window.ov.ampere.util.ucwords(e.name()):e instanceof State?t=window.ov.ampere.util.ucwords(e.name()):e instanceof Module?t=window.ov.ampere.util.ucwords(e.name()):typeof e=="string"&&(t=window.ov.ampere.util.ucwords(e))),t!==undefined?t:e},this.getDescription=function(e){return this._get("ampere.ui.description",e,["transition","view","target","state"])},this.getAbout=function(e){return this._get("ampere.ui.about",e)},this.getIcon=function(e){return this._get("ampere.ui.icon",e,["transition","view","target","module"])}}function UiController(t,n,r){if(!(this instanceof UiController))return new UiController(t,n,r);var i=this,s=e.ov.namespace(n.fullName()+"::UiController");this.options=Options(r),this.module=n,this.element=t,n.history().reset(),this.element.addClass("ampere-app"),e.when(n).done(function(){var e=i.options("ampere.state")||i.module.current().state||n.options("ampere.state");if(typeof e=="string"){var t=n.states[e];s.assert(t instanceof State,'configured default state "',e,'" not found in ',n.fullName(),".states"),e=t}else if(!e)for(var r in n.states){e=n.states[r];break}var o=i.options("ampere.view")||i.module.current().view||n.options("ampere.view");if(typeof o=="string"){var u=e.views[o];s.assert(u instanceof View,'configured default view "',o,'" not found in ',e.fullName()+".views"),o=u}else if(!o)for(var a in e.views){o=e.views[a];break}i.ui=i.options("ampere.ui")||n.options("ampere.ui"),s.assert(!(i.ui instanceof Ampere.ui),"controller.options( 'ui') expected to be a ampere ui constructor function but is an object ",i.ui),i.ui=new i.ui(i,angular.extend({},n.options(),i.options())),n.current(e,o),i.element.data("ampere.controller",i),i.ui.render("Bootstrap")}),this.proceed=function(t,n){var r;if(t.enabled()&&(r=t.target())){var o=t.action();if(o===this.module.history().undo||o===this.module.history().redo)o.call(this.module.history());else if(o===this.module.history().reset)o.call(this.module.history()),this.ui.render("State");else if(o===this.module.current.reset)this.module.current.reset(),this.ui.render("State",this.module.current().view);else{var u=o.call(t,t,this.ui,n);if(!u)return!1;var a=e.isFunction(u)?e.Deferred(function(){this.resolve(u)}):u;a.done(function(e){var n=t.options("ampere.state.view")||r.options("ampere.state.view");if(typeof n=="string"){var o=r.views[n];s.assert(o instanceof View,'target view "',n,'" not found in ',r.fullName(),".views"),n=o}else if(!n)for(var u in r.views){n=r.views[u];break}i.module.history().redo({command:e,source:t.state(),target:t.target(),view:n,ui:i.ui})})}return!0}return!1},this.destroy=function(){this.element.removeClass("ampere-app"),this.ui.destroy()},this.getView=function(t){var n=this.module.current().state.options("ampere.state.view")||this.module.options("ampere.state.view");e.isFunction(n)&&(n=n.call(n,this.module.current().state));if(this.module.current().state.views[n])return this.module.current().state.views[n];var r=Object.keys(this.module.current().state.views);return r.length==1?this.module.current().state.views[r[0]]:this.module.current().state.views.main?this.module.current().state.views.main:this.module.current().state.views[r[0]]}}Ampere.defaults={"ampere.state":"main","ampere.state.view":"main","ampere.ui.options":{},"ampere.history.limit":Number.MAX_VALUE,"ampere.history.html5":!1,"ampere.baseurl":function(){var e=document.getElementsByTagName("script");for(var t=0;t<e.length;t++){var n=e[t].src;if(/oval.js/.test(n)){var r=n.match(/(.+)oval\.js(\?(.+))?/);if(r)return r[1]}}return document.location.href}()},Ampere.type=function(n){return n instanceof Ampere?"ampere":n instanceof Module?"module":n instanceof State?"state":n instanceof Transition?"transition":n instanceof View?"view":e.type(n)},Ampere.ui=Ui,window.ov=window.ov||{},window.ov.ampere=Ampere,e.fn.ampere=function(t,n){if(arguments.length){n=n||{},e.isFunction(t)&&("ampere.history.html5"in n||(n["ampere.history.html5"]=this[0].tagName=="BODY"&&window.top===window.self),t=new t(n));var r=e.ov.namespace("jQuery.fn.ampere()").assert(t instanceof Module,"argument expected to be a ampere module").assert(this.length==1,"context expected to reference a single dom element but was ",this.get());return UiController(this,t,n)}return this.data("ampere.controller")}}(jQuery),window.ov&&window.ov.ampere&&window.ov.ampere.util||function(e){window.ov.ampere.util={ucwords:function(t){return typeof t=="string"||(t=""+t),t?t.replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()}):t},functionName:function(e){return e.name!==undefined?e.name:e.toString().match(/^function ([^(]+)/)[1]}}}(jQuery),window.ov&&window.ov.ampere&&window.ov.ampere.ui.twitterbootstrap||function(e){function n(){if(!e(".subnav").attr("data-top")){if(e(".subnav").hasClass("subnav-fixed"))return;var t=e(".subnav").offset()||{};e(".subnav").attr("data-top",t.top)}e(this).scrollTop()&&e(".subnav").attr("data-top")-e(".subnav").outerHeight()<=e(this).scrollTop()?e(".subnav").addClass("subnav-fixed"):e(".subnav").removeClass("subnav-fixed")}function r(t){var n=angular.element(this).scope().transition,r=e(this).closest(".ampere-app").ampere();!r.ui.isBlocked()&&r.proceed(n,[t]),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}function i(e){var t=e.find(".ampere-state .ampere-view input,select,textarea,button").filter('[tabIndex!="-1"]:visible:enabled');t.filter("*[autofocus]").focus().length||t.first().focus()}function s(){e.ov.namespace("twitterboostrap::onActionAbort()").debug("action aborted");var n=e(this).closest(".ampere-app").ampere();if(window.confirm("Really abort transition ?")){n.ui.flash();var r=n.ui.flash.getElement().data("ampere.action-deferred");t.assert(r&&e.isFunction(r.promise),"no action deferred registered on flash element"),r.reject(n.module)}}function o(t){var n=e(this).find('[class^="icon-"]:first');n.length&&t.originalEvent.dataTransfer.setDragImage(n[0],-10,-10),t.originalEvent.dataTransfer.setData("DownloadURL",e(this).data("downloadurl")||"application/octet-stream:"+this.href.replace(/^.*[\/\\]/g,"")+":"+this.href)}function u(a,f){function v(e){var t=e.originalEvent.source.location;v.handlers[t]&&v.handlers[t](e.originalEvent.data,e.originalEvent.source)}if(!(this instanceof u))return new u(a,f);var l=this;this._super(a,angular.extend({},u.defaults,f||{}));var c="default";Object.hasOwnProperty.call(this.options(),"ampere.ui.layout")&&(c=this.options("ampere.ui.layout"),c||(c="nolayout"));var h;if(e.inArray(c,["default","nolayout","wizard"])!=-1){var p="ampere-ui-twitterbootstrap.layout."+c+".tmpl";h=c,document.getElementById(p)?c=e(document.getElementById(p)):c=this.options("ampere.baseurl")+"ampere-ui-twitterbootstrap.layout."+c+".tmpl",a.element.addClass("layout-name-"+h)}else typeof c=="string"&&(document.getElementById(c)&&(c=e(document.getElementById(c))),a.element.addClass("layout-name-"+c.replace(/(^.*[\/\\])|\./g,"")));this.layout=typeof c=="string"?e.get(c):c;for(h in a.module.transitions){var d=a.module.transitions[h];"ampere.ui.type"in d.options()||d.options("ampere.ui.type","global")}v.handlers={};var m=this.init;this.init=function(){m.call(this),this.controller.element[0].tagName=="BODY"&&e(window).on("resize",n),this.controller.element[0].tagName=="BODY"&&e(document).on("scroll",n),this.controller.element.on("click",".ampere-transition:not( .ampere-transition-companion)",r),this.controller.element.on("click",".flash .alert button.close",s),e(this.controller.element).on("dragstart","a[draggable]",o),e(window).on("message",v),i(a.element)};var g=this.destroy;this.destroy=function(){g.call(this),this.controller.element[0].tagName=="BODY"&&e(window).off("resize",n),this.controller.element[0].tagName=="BODY"&&e(document).off("scroll",n),this.controller.element.off("click",".ampere-transition",r),this.controller.element.off("click",".flash .alert button.close",s),e(this.controller.element).off("dragstart","a[draggable]",o),e(window).off("message",v)},this.flash=function(t,n){if(arguments.length){n=n||{};var r=this.flash.getElement();switch(n.type){case"progress":r.find(".alert").removeClass("alert-error").addClass("alert-info"),r.find(".progress").show().find(".bar").css("width",n.value),r.find(".message").text(t);var i=n.deferred;r.find("button.close")[i&&e.isFunction(i.reject)?"show":"hide"]();break;case"error":r.find(".alert").removeClass("alert-info").addClass("alert-error"),r.find(".progress").hide(),r.find(".message").text("Error occured : "+t);if(n.value){var s=e('<button class="btn retry"><i class="icon-refresh"></i>Retry</button>');s.click(function(){r.hide(),n.value()}),r.find(".message").append(s)}r.find("button.close").hide();break;default:r.find(".alert").removeClass("alert-error alert-info"),r.find(".progress, button.close").hide(),r.find(".message").text(t),r.show().fadeOut(1e3);return}r.show()}else this.flash.getElement().hide();return this.flash},this.flash.getElement=function(){return a.element.find(".flash")},this.flash.progress=function(e,t,n){return l.flash(e||"Operation in progress ...",{type:"progress",value:t||"100%",deferred:n||l.flash.getElement().data("ampere.action-deferred")})},this.flash.error=function(e,t){return l.flash(e,{type:"error",value:t})},this.isBlocked=function(){return this.controller.element.find(".overlay").hasClass("block")},this.block=function(){this.controller.element.addClass("overlay").find(".overlay").addClass("block")},this.unblock=function(){this.controller.element.removeClass("overlay").find(".overlay").removeClass("block")},this.getTemplate=function(t){var n=t.template();return!n&&n!==""?(n=this.options("ampere.ui.view"),typeof n=="string"?document.getElementById(n)?n=e(document.getElementById(n)):n=e.get(t):n||(n="ampere-ui-twitterbootstrap.view.default.tmpl",document.getElementById(n)?n=e(document.getElementById(n)):n=e.get(this.options("ampere.baseurl")+n))):e.isFunction(n)&&(n=n.call(t,t)),e.ov.namespace("ngState").assert(!e.isFunction(n.promise)||n.promise().state()!="success","view fragment is not ready : state=",e.isFunction(n.promise)?n.promise().state():""),e.when(e.isFunction(n.promise)?n.promise():n)},this.renderAction=function(e){this.flash.progress("Transition in progress ...","100%",e).getElement().data("ampere.action-deferred",e),e.progress(l.flash.progress).then(function(){l.flash().getElement().removeData("ampere.action-deferred")})},this.renderError=function(e,t){this.flash.error(e,t)},this.renderState=function(t,n,r){var s=window.scrollX,o=window.scrollY,u=angular.element(a.element.find(">.ampere-module")).scope();u.$apply(function(){t&&(u.$ampere={module:a.module,ui:a.ui,view:t,template:n===""?n:n||u.$ampere.template})}),e.when(r).done(function(){i(a.element),window.scrollTo(s,o),arguments.length==1&&typeof arguments[0]=="string"&&l.flash(arguments[0])})},this.modal=function(t,n){n=n||{};var r,i=e.noop;n.container?(r=e('<div class="modal-embed-backdrop"></div><div class="container modal-embed"><iframe border="no" src="'+t+'"></iframe></div>'),a.element.addClass("modal-embed"),n.container.addClass("modal-embed-container").append(r),t=r.find("iframe")[0].src,i=function(){a.element.removeClass("modal-embed"),n.container.removeClass("modal-embed-container"),r.remove()}):(r=e('<div class="container modal-popup"><iframe width="100%" height="100%" border="no" src="'+t+'"></iframe></div>'),a.element.addClass("modal-popup").find(".ampere-module").append(r),t=r.find("iframe")[0].src,i=function(){a.element.removeClass("modal-popup"),r.remove()}),r.find("iframe").focus();var s=e.Deferred(n.callback||e.noop);return v.handlers[t]=e.proxy(n.onMessage||e.noop,s),s.always(function(){i(),delete v.handlers[t]}),s},this.toggleHelp=function(){a.element.find(".page-header >.ampere-help").toggle("slow")},this.renderBootstrap=function(){var n=this.controller,r=e('<div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div>');n.element.append(r).css("cursor","wait");var i=n.element.find(".bar");i.text("Bootstrapping "+n.module.name()+" ...");var s=e.Deferred();return e.when(n.module.current().view,n.module.current().view.template,this.layout,n.module).progress(function(){t.debug("progress",this,arguments)}).always(function(){i.css("width","100%"),n.element.css("cursor","")}).fail(function(t){i.text("Bootstrapping "+n.module.name()+" failed ! ").append(e('<a href="#">Details</a>').one("click",function(){n.element.append('<div class="alert">'+(l.layout.isRejected()?l.layout.statusText+" : "+c:e.ov.json.stringify(t,e.ov.json.stringify.COMPACT))+"</div>")})),e(".progress",n.element).addClass("progress-danger")}).done(function(){r.remove(),n.element.append(l.layout.responseText?l.layout.responseText:l.layout.jquery&&l.layout[0].tagName=="SCRIPT"?l.layout.text().replace("<![CDATA[","").replace("]]>",""):l.layout);var t=l.getTemplate(n.module.current().view);t.done(function(r){r instanceof HTMLElement&&(r=e(r)),t=r.jquery?r[0].tagName=="SCRIPT"?r.text().replace("<![CDATA[","").replace("]]>",""):r:t.responseText||r,n._initial_template=t,angular.bootstrap(n.element.find(">.ampere-module").addClass("name-"+n.module.name()),["window.ov.ampere.ui.twitterbootstrap"]),l.init(),s.resolve()})}),s}}var t=e.ov.namespace("window.ov.ampere.ui.twitterbootstrap");(function(){function r(n){var r="ngAmpere"+window.ov.ampere.util.ucwords(n);t.directive(r,[function(){var t=e.ov.namespace(r);return{restrict:"A",link:function(i,s,o){e(s).on(n,function(e){var s=i.$eval(o[r]);if(s){var u=i.$ampere.ui,a=u.controller;!u.isBlocked()&&a.proceed(s,[e])}else t.error('attribute "ng-ampere-'+n+'" (='+o[r]+") doesnt resolve to an ampere transition");e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})}}}])}var t=angular.module("window.ov.ampere.ui.twitterbootstrap",["ngResource","ngCookies"]).run(function(){});t.filter("ucwords",function(){return function(e,t){return window.ov.ampere.util.ucwords(e)}}),t.filter("replace",function(){return function(e,t,n){var r=t.lastIndexOf("/"),i=new RegExp(t.substr(1,r-1),t.substr(r+1));return e.replace(i,n)}}),t.filter("next",function(){return function(t,n){var r=e.inArray(n,t);return r<t.length-1?t[r+1]:n}}),t.filter("prev",function(){return function(t,n){var r=e.inArray(n,t);return r>0?t[r-1]:n}}),t.filter("type",function(){return function(e){return window.ov.ampere.type(e)}}),t.filter("match",function(){return function(t,n,r){return e.isArray(r)||(r=[r]),e.grep(t,function(e){for(var t in r)if(r[t]instanceof RegExp?r[t].test(e[n]):e[n]==r[t])return!0})}});var n=function(t,n,r,i,s,o,u,a){var f=n.parent().data("ampere.controller"),l=f._initial_template;f._initial_template=undefined,t.$ampere={module:f.module,ui:f.ui,template:l,view:f.module.current().view},t.$window=r,t.$http=i,t.$timeout=s,t.$log=o,t.$resource=u,t.$cookies=a,t.$=e};n.$inject=["$scope","$rootElement","$window","$http","$timeout","$log","$resource","$cookies"],t.controller("amperetwitterbootstrap",n),t.directive("ngAmpereState",["$compile","$window",function(t,n){return{restrict:"A",scope:"isolate",link:function(r,i,s){r.$watch("$ampere",function(){while(r.$$childHead)r.$$childHead.$destroy();var s=e.ov.namespace("ngAmpereTransition("+r.$ampere.module.current().state.fullName()+")");s.debug("ampere changed");var o,u=Object.keys(r);for(o in u)u[o]!="this"&&u[o].charAt(0)!="$"&&(s.debug("delete previsouly defined scope."+u[o]),delete r[u[o]]);u=Object.keys(r.$ampere.module.current().state);for(o in u)e.ov.namespace("ngState").assert(u[o]!="this",'state property named "this" is forbidden').assert(u[o].charAt(0)!="$",'state property starting with $ (="',u[o],'") is forbidden'),u[o]!="promise"&&(r[u[o]]=r.$ampere.module.current().state[u[o]],s.debug("set initial scope."+u[o]+"=",n.$.ov.json.stringify(r[u[o]],n.$.ov.json.stringify.COMPACT)));var a=r.$ampere.template;s.debug("template="+a),i.html(a),t(i.contents())(r)}),r.$watch(function(){var t=e.ov.namespace("ngAmpereTransition("+r.$ampere.module.current().state.fullName()+")"),i,s={},o=Object.keys(r);for(i in o)o[i]!="promise"&&o[i]!="this"&&o[i].charAt(0)!="$"&&(s[o[i]]=r[o[i]]);o=Object.keys(s),n.jQuery.each(Object.keys(r.$ampere.module.current().state),function(t,n){e.inArray(n,o)!=-1||o.push(n)});var u=[],a=[];for(i in o){var f=o[i];f!="promise"&&(Object.hasOwnProperty.call(s,f)?angular.equals(s[f],r.$ampere.module.current().state[f])?delete s[f]:a.push(f):u.push(f))}if(a.length||u.length){for(i in a)r.$ampere.module.current().state[a[i]]=s[a[i]],t.debug(r.$ampere.module.current().state.fullName(),".",a[i],"=",s[a[i]]);for(i in u)delete r.$ampere.module.current().state[u[i]],t.debug("delete ",r.$ampere.module.current().state.fullName(),".",u[i]);t.debug("broadcast ampere-model-changed ( ",s,", ",u,")"),r.$root.$broadcast("ampere-model-changed",s,u)}})}}}]),t.directive("ngAmpereTransition",["$compile","$parse","$window",function(t,n,r){var i={a:'<a href="javascript:void(0)" class="ampere-transition name-{{transition.name()}} {{attrs.class}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" accesskey="{{attrs.accesskey}}" id="{{attrs.id}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition)}}{{hotkey && \' \' + hotkey}}"><i ng-class="$ampere.ui.getIcon( transition)"></i>{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</a>',button:'<button type="button" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn {{attrs.class}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" id="{{attrs.id}}" accesskey="{{attrs.accesskey}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition)}}{{hotkey && \' \' + hotkey}}"><i ng-class="$ampere.ui.getIcon( transition)"></i>{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button>',file:'<button type="button" onclick="$( this).next().click()" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn ampere-transition-companion {{attrs.class}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" accesskey="{{attrs.accesskey}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition)}}{{hotkey && \' \' + hotkey}}"><i ng-class="$ampere.ui.getIcon( transition)"></i>{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button><input id="{{attrs.id}}" name="{{attrs.name}}" class="ampere-transition-companion" ng-class="{disabled : !transition.enabled()}" type="file" ng-ampere-change="transition">',submit:'<button type="submit" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn {{attrs.class}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" id="{{attrs.id}}" accesskey="{{attrs.accesskey}}" style="{{attrs.style}}" data:ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition)}}{{hotkey && \' \' + hotkey}}"><i ng-class="$ampere.ui.getIcon( transition)"></i>{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button>',reset:'<button type="reset" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn {{attrs.class}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" accesskey="{{attrs.accesskey}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition)}}{{hotkey && \' \' + hotkey}}"><i ng-class="$ampere.ui.getIcon( transition)"></i>{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button>'},s=e.ov.namespace("ngAmpereTransition");return{restrict:"A",scope:"isolate",link:function(n,o,u){n.element=o,n.attrs=u,n.$=r.jQuery,n.$on("ampere-model-changed",function(e,t){n.transition&&(n.$enabled=n.transition.enabled())}),n.$watch(u.ngAmpereTransition,function(r,a){if(!a){o.replaceWith('<span style="background-color:crimson; color:white">attribute "ng-ampere-transition" (="'+u.ngAmpereTransition+'") does not resolve to a ampere transition'+"</span>");return}s=e.ov.namespace("ngAmpereTransition("+a.fullName()+")");var f=u.type||(e.inArray(o[0].tagName.toLowerCase(),Object.keys(i))!=-1?o[0].tagName.toLowerCase():"button");n.transition=a,n.$enabled=n.transition.enabled(),s.assert(e.type(n.transition)=="object"&&n.transition.constructor&&n.transition.constructor.name=="Transition",'attribute "ng-ampere-transition" (="',u.ngAmpereTransition,'") does not resolve to a ampere transition');if(i[f]){var l=i[f];if(f=o[0].tagName=="A")l=l.replace(/\type="button"|btn/g,"").replace(/button/g,"a");var c=t(l),h=c(n);o.replaceWith(h),h.tabIndex=o.tabInde;var p=Object.keys(o[0].dataset);for(var d=0;d<p.length;d++)h.attr("data-"+p[d],o[0].dataset[p[d]]);var v=u.ngAmpereHotkey||n.$ampere.ui.getHotkey(n.transition);v&&(n.hotkey=" ("+window.ov.ampere.util.ucwords(v)+")"),h.data("ampereTransition",a)}else s.raise('type "',f,'" is unknown')})}}}]),r("change"),r("click"),r("dblclick"),t.directive("ngAmpereDrop",[function(){var t=e.ov.namespace("ngAmpereDrop");return{restrict:"A",link:function(n,r,i){e(r).on("drop",function(e){var r=n.$eval(i.ngAmpereDrop);if(r){var s=n.$ampere.ui,o=s.controller;!s.isBlocked()&&o.proceed(r,[e])}else t.error('attribute "ngAmpereDrop" (='+i.ngAmpereDrop+") doesnt resolve to an ampere transition");return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}).on("dragover",function(e){e.preventDefault()})}}}]),t.directive("ngAmpereSortable",function(t){var n=e.ov.namespace("ngAmpereSortable");return{restrict:"A",link:function(r,i,s){var o={forcePlaceholderSize:!0,placeholder:i[0].tagName=="TBODY"&&e("<tr><td></td></tr>")},u,a=r.$eval(s.ngAmpereSortable);e.isPlainObject(a)?(n.assert((!Object.hasOwnProperty.call(a,"transition")||a.transition)&&(!Object.hasOwnProperty.call(a,"ng-ampere-transition")||a["ng-ampere-transition"]),"value option transition or ng-ampere-transition doesnt resolve to a transition"),u=a["ng-ampere-transition"]||a.transition||u,e.extend(o,a)):a&&(u=a),t(function(){var t=e(i.get()).sortable(o),n=r.$ampere.ui,s=n.controller;u&&t.on("sortupdate",function(e,t){e.data={items:t.item,position:t.item.index()},!n.isBlocked()&&s.proceed(u,[e]),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()})})}}}).$inject=["$timeout"],t.directive("ngAmpereHotkey",[function(){var t=e.ov.namespace("ngAmpereHotkey");return{restrict:"A",link:function(n,r,i){if(!i.ngAmpereTransition){var s=n.$eval(i.ngAmpereHotkey);t.assert(e.isPlainObject(s),'attribute "ng-ampere-hotkey"(="'+i.ngAmpereHotkey+'") expected to evaluate to an object'),r.data("ampereHotkey",s)}}}}]),t.directive("ngAmpereData",[function(){var t=e.ov.namespace("ngAmpereData");return{restrict:"A",link:function(n,r,i){var s=n.$eval(i.ngAmpereData);t.assert(e.isPlainObject(s),'attribute "ng-ampere-data"(="'+i.ngAmpereData+'") expected to evaluate to an object'),angular.extend(r.data(),s)}}}])})(),u.prototype=window.ov.ampere.ui(),u.defaults={"ampere.ui.twitterbootstrap.theme":"default"},window.ov.ampere.defaults["ampere.ui"]=window.ov.ampere.ui.twitterbootstrap=u,window.top!==window.self&&e("html").addClass("iframe")}(jQuery),window.ov&&window.ov.ampere&&window.ov.ampere.ui.hotkey||function(e){function i(e){var t=e.type!=="keypress"&&n[e.which],i=String.fromCharCode(e.which).toLowerCase(),s,o="",u=[];return e.altKey&&t!=="alt"&&(o+="alt_"),e.ctrlKey&&t!=="ctrl"&&(o+="ctrl_"),e.metaKey&&!e.ctrlKey&&t!=="meta"&&(o+="meta_"),e.shiftKey&&t!=="shift"&&(o+="shift_"),t?u.push(o+t):(u.push(o+i),u.push(o+r[i]),o==="shift_"&&u.push(r[i])),u}var t=e.ov.namespace("window.ov.ampere.ui.twitterbootstrap"),n={8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},r={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"};window.ov.ampere.ui.hotkey={computeMatchingHotkeys:i}}(jQuery);